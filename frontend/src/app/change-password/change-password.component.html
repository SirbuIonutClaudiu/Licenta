<link rel="stylesheet" href="change-password.component.css">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<div class="pageloader">
  <div class="form-gap"></div>
  <div class="container" style="margin-top: 10%">
    <div class="row">
      <div class="col-md-4 col-md-offset-4">
        <div class="panel panel-default">

                <div class="card card-outline-secondary">
                  <div class="card-header">
                    <h3 class="mb-0" style="text-align: center">Change Password</h3>
                  </div>
                  <div class="card-body">
                      <div class="form-group">
                        <label for="password">New Password</label>
                        <div class="flexContainer">
                        <input [type]="showPassword ? 'text' : 'password'"
                               class="form-control inputField"
                               id="password"
                               name="password"
                               [(ngModel)]="password"
                               (blur)="passwordUnblurred()">
                          <button type="button" *ngIf="!showPassword"
                                  class="btn btn-outline-success showPass"
                                  id="inputGroupFileAddon041"
                                  title="Show"
                                  (click)="toggleShowPassword()">
                            <i class="fa fa-eye" aria-hidden="true"></i>
                          </button>
                          <button type="button" *ngIf="showPassword"
                                  class="btn btn-outline-success showPass"
                                  id="inputGroupFileAddon042"
                                  title="Don't show"
                                  (click)="toggleShowPassword()">
                            <i class="fa fa-eye-slash" aria-hidden="true"></i>
                          </button>
                        </div>
                        <span class="form-text h5" [ngClass]="{'text-success': ((passwordLengthError === false) && !firstUnblur), 'text-danger': ((passwordLengthError === true) && !firstUnblur), 'text-secondary': firstUnblur}">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-x-lg mr-2 icon-inline text-danger"  viewBox="0 0 16 16" *ngIf="passwordLengthError && !firstUnblur">
                            <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-check2 mr-2 icon-inline text-success" viewBox="0 0 16 16" *ngIf="!passwordLengthError && !firstUnblur">
                            <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                          </svg>
                          {{firstUnblur ? 'Needs to be 8-120 characters long.' : 'Has 8-120 characters'}}
                        </span>
                        <span class="form-text h5" [ngClass]="{'text-success': ((passwordLowercaseError === false) && !firstUnblur), 'text-danger': ((passwordLowercaseError === true) && !firstUnblur), 'text-secondary': firstUnblur}">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-x-lg mr-2 icon-inline text-danger"  viewBox="0 0 16 16" *ngIf="passwordLowercaseError && !firstUnblur">
                            <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-check2 mr-2 icon-inline text-success" viewBox="0 0 16 16" *ngIf="!passwordLowercaseError && !firstUnblur">
                            <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                          </svg>
                          {{firstUnblur ? 'Has to contain at least one lowercase character' : 'Contains at least one lowercase character'}}
                        </span>
                        <span class="form-text h5" [ngClass]="{'text-success': ((passwordNumberError === false) && !firstUnblur), 'text-danger': ((passwordNumberError === true) && !firstUnblur), 'text-secondary': firstUnblur}">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-x-lg mr-2 icon-inline text-danger"  viewBox="0 0 16 16" *ngIf="passwordNumberError && !firstUnblur">
                            <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-check2 mr-2 icon-inline text-success" viewBox="0 0 16 16" *ngIf="!passwordNumberError && !firstUnblur">
                            <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                          </svg>
                          {{firstUnblur ? 'Has to contain at least one number' : 'Contains at least one number'}}
                        </span>
                        <span class="form-text h5" [ngClass]="{'text-success': ((passwordUppercaseError === false) && !firstUnblur), 'text-danger': ((passwordUppercaseError === true) && !firstUnblur), 'text-secondary': firstUnblur}">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-x-lg mr-2 icon-inline text-danger"  viewBox="0 0 16 16" *ngIf="passwordUppercaseError && !firstUnblur">
                            <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-check2 mr-2 icon-inline text-success" viewBox="0 0 16 16" *ngIf="!passwordUppercaseError && !firstUnblur">
                            <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                          </svg>
                          {{firstUnblur ? 'Has to contain at least one upercase character' : 'Contains at least one uppercase character'}}
                        </span>
                      </div>
                      <div class="form-group">
                        <label for="verify">Verify new password</label>
                        <div class="flexContainer">
                          <input [type]="showVerifyPassword ? 'text' : 'password'"
                               class="form-control inputField"
                               id="verify"
                               name="verify"
                               (blur)="verifyUnblurred()"
                               [(ngModel)]="verify">
                          <button type="button" *ngIf="!showVerifyPassword"
                                  class="btn btn-outline-success showPass"
                                  id="inputGroupFileAddon043"
                                  title="Show"
                                  (click)="toggleShowVerifyPassword()">
                            <i class="fa fa-eye" aria-hidden="true"></i>
                          </button>
                          <button type="button" *ngIf="showVerifyPassword"
                                  class="btn btn-outline-success showPass"
                                  id="inputGroupFileAddon044"
                                  title="Don't show"
                                  (click)="toggleShowVerifyPassword()">
                            <i class="fa fa-eye-slash" aria-hidden="true"></i>
                          </button>
                        </div>
                        <span class="form-text h5" [ngClass]="{'text-success': ((verifyPasswordError === false) && !secondUnblur), 'text-danger': ((verifyPasswordError === true) && !secondUnblur), 'text-secondary': secondUnblur}">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-x-lg mr-2 icon-inline text-danger"  viewBox="0 0 16 16" *ngIf="verifyPasswordError && !secondUnblur">
                            <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke-linecap="round" stroke-linejoin="round"
                               class="bi bi-check2 mr-2 icon-inline text-success" viewBox="0 0 16 16" *ngIf="!verifyPasswordError && !secondUnblur">
                            <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                          </svg>
                          {{secondUnblur ? 'Passwords must match' : (verifyPasswordError ? 'Passwords do not match' : 'Passwords match')}}
                        </span>
                      </div>
                      <div class="form-group">
                        <button type="submit" [disabled]="passwordError || verifyPasswordError || !password.length || !verify.length"
                                class="btn btn-success btn-lg float-right"
                                (click)="resetPassword()">Save</button>
                      </div>
                  </div>
                </div>
        </div>
        <div
          class="carder alert alert-danger"
          role="alert"
          *ngIf="showFeedback==2">
          <b>Form failed</b> :<br> {{ errorMessage }}
          <br><br>
          <button type="button"
                  class="btn btn-warning btn-rounded"
                  [routerLink]="['/forgot_password']">
            Resend reset email
          </button>
          <br><br>
          <button type="button"
                  class="btn btn-primary btn-rounded"
                  [routerLink]="['/login']">
            Go to Login
          </button>
        </div>
        <div class="carder alert alert-success"
             role="alert"
             *ngIf="showFeedback==1">
          <b>Form successfull</b> : {{ successMessage }}
          <br><br>
          <button type="button"
                  class="btn btn-info btn-rounded"
                  [routerLink]="['/login']">
            Go to Login
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

